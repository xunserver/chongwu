# 手工测试规格

## 介绍

本文档定义认证模块在手工测试阶段需要覆盖的全部场景，包括登录、登出、多因素认证（MFA）注册与验证、凭证找回等流程，重点覆盖桌面端与移动端的真实使用路径，确保身份关键链路在发布前被充分验证。

## 与产品愿景的对齐

产品承诺为终端用户与管理员提供安全可靠的访问控制体验。通过完善的手工回归测试强化认证模块，可以保护用户数据、满足合规要求，并保证新业务特性上线时不会削弱身份安全基线。

## 需求

### 需求 1

**用户故事：** 作为 QA 工程师，我需要一套可重复执行的正向认证脚本，以便每个构建都能验证用户顺利登录并维持有效会话。

#### 验收标准

1. 当测试人员在 Web 端或移动端使用正确凭证登录时，系统应在 5 秒内返回成功并跳转至默认仪表盘。
2. 如果测试人员登录后刷新页面或打开新标签页，系统应复用现有会话令牌并跳过重新输入凭证。
3. 当测试人员登出并立即访问受保护的路由时，系统应重定向到登录页并使旧会话 Cookie 失效。

### 需求 2

**用户故事：** 作为 QA 工程师，我需要覆盖异常凭证和安全防护场景，确保暴力破解保护与用户提示信息保持准确。

#### 验收标准

1. 当测试人员连续 5 次输入错误密码时，系统应按策略限制速率或锁定账号，并显示冷却计时器。
2. 如果测试人员尝试使用被禁用的账号登录，系统应拒绝请求、记录审计日志，并展示升级处理指引。
3. 当测试人员在生产环境通过 HTTP 提交凭证时，系统应在请求到达认证服务前拦截并记录 HSTS 违规。

### 需求 3

**用户故事：** 作为发布经理，我需要验证恢复与 MFA 边界场景，以确保部署期间安全关键流程稳定可用。

#### 验收标准

1. 当测试人员触发忘记密码流程时，系统应发送 30 分钟内有效的单次重置邮件并记录日志。
2. 如果测试人员启用 MFA 后在新设备登录，系统应提示第二因子通过后再签发访问令牌。
3. 当测试人员输入过期恢复码并请求新验证码时，系统应使所有旧码失效并通过邮件确认。

## 非功能需求

### 架构与模块化

- **单一职责**：每条测试仅聚焦一项认证能力（会话、凭证、恢复），方便追踪执行记录。
- **模块化设计**：按旅程（正向、异常、恢复/MFA）分类，便于独立维护。
- **依赖管理**：明确所需夹具（预置用户、设备信任标记、邮件捕获服务），避免隐式共享状态。
- **清晰接口**：描述具体入口（Web 表单、REST API、移动深链）以减少歧义。

### 性能

- 手工测试需确认成功认证响应在稳定环境中持续低于 2 秒，并记录异常波动。

### 安全

- 覆盖 TLS 强制、凭证存储策略（禁止明文）以及成功/失败事件的审计日志。

### 可靠性

- 测试脚本提供可复现步骤及数据种子，确保不同测试人员获得一致结果且无需使用个人账号。

### 可用性

- 验证认证界面的文案、错误状态和可访问性（标签、焦点顺序）在桌面与移动断点均符合最新 UX 指南。
